# ä¸­æ–‡æ™ºèƒ½åˆçº¦ç¼–è¯‘å™¨ (Chinese Solidity Compiler)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.11+](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)

ä¸€ä¸ªæ”¯æŒä½¿ç”¨ä¸­æ–‡è¯­æ³•ç¼–å†™æ™ºèƒ½åˆçº¦çš„ç¼–è¯‘å™¨ï¼Œå¯ä»¥å°†ä¸­æ–‡ä»£ç ç¼–è¯‘ä¸ºæ ‡å‡†çš„ Solidity ä»£ç ï¼Œéƒ¨ç½²åˆ° BSCï¼ˆå¸å®‰æ™ºèƒ½é“¾ï¼‰åŠå…¶ä»– EVM å…¼å®¹é“¾ã€‚

## âœ¨ ç‰¹æ€§

- **ğŸ‡¨ğŸ‡³ ä¸­æ–‡è¯­æ³•**ï¼šä½¿ç”¨"åˆçº¦"ã€"å‡½æ•°"ã€"æ•´æ•°"ç­‰ä¸­æ–‡å…³é”®å­—ç¼–å†™æ™ºèƒ½åˆçº¦
- **ğŸ”„ å³æ—¶ç¼–è¯‘**ï¼šè‡ªåŠ¨å°†ä¸­æ–‡ä»£ç è½¬æ¢ä¸ºæ ‡å‡† Solidity ä»£ç 
- **ğŸ¯ æ™ºèƒ½è½¬æ¢**ï¼šä¸­æ–‡å˜é‡åè‡ªåŠ¨è½¬æ¢ä¸ºæ‹¼éŸ³ï¼Œä¿ç•™ä¸­æ–‡æ³¨é‡Š
- **ğŸ“ å®Œæ•´æ”¯æŒ**ï¼šæ”¯æŒçŠ¶æ€å˜é‡ã€å‡½æ•°ã€äº‹ä»¶ã€requireã€emit ç­‰å¸¸ç”¨åŠŸèƒ½
- **ğŸŒ åœ¨çº¿ä½“éªŒ**ï¼šæä¾›åœ¨çº¿ç¼–è¯‘å™¨ï¼Œæ— éœ€å®‰è£…å³å¯ä½¿ç”¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pip install pypinyin
```

### ç¼–å†™ç¬¬ä¸€ä¸ªåˆçº¦

åˆ›å»º `hello.zhs` æ–‡ä»¶ï¼š

```
åˆçº¦ é—®å€™ {
    å…¬å¼€ å­—ç¬¦ä¸² æ¶ˆæ¯ = "ä½ å¥½ï¼Œä¸–ç•Œï¼";
    
    å‡½æ•° è·å–æ¶ˆæ¯() å…¬å¼€ åªè¯» è¿”å› å­—ç¬¦ä¸² {
        è¿”å› æ¶ˆæ¯;
    }
    
    å‡½æ•° è®¾ç½®æ¶ˆæ¯(å­—ç¬¦ä¸² æ–°æ¶ˆæ¯) å…¬å¼€ {
        æ¶ˆæ¯ = æ–°æ¶ˆæ¯;
    }
}
```

### ç¼–è¯‘åˆçº¦

```python
from compiler import compile_file

# ç¼–è¯‘æ–‡ä»¶
compile_file('hello.zhs', 'hello.sol', verbose=True)
```

ç”Ÿæˆçš„ Solidity ä»£ç ï¼š

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract WenHou {
    string public XiaoXi = "ä½ å¥½ï¼Œä¸–ç•Œï¼";  // æ¶ˆæ¯
    
    function HuoQuXiaoXi() public view returns (string) {  // è·å–æ¶ˆæ¯
        return XiaoXi;
    }
    
    function SheZhiXiaoXi(string XinXiaoXi /* æ–°æ¶ˆæ¯ */) public {  // è®¾ç½®æ¶ˆæ¯
        XiaoXi = XinXiaoXi;
    }
}
```

## ğŸ“š è¯­æ³•è¯´æ˜

### åŸºæœ¬ç±»å‹

| ä¸­æ–‡ | Solidity | è¯´æ˜ |
|------|----------|------|
| æ•´æ•° | uint256 | æ— ç¬¦å·æ•´æ•° |
| æœ‰ç¬¦å·æ•´æ•° | int256 | æœ‰ç¬¦å·æ•´æ•° |
| åœ°å€ | address | ä»¥å¤ªåŠåœ°å€ |
| å¸ƒå°” | bool | å¸ƒå°”å€¼ |
| å­—ç¬¦ä¸² | string | å­—ç¬¦ä¸² |
| å­—èŠ‚ | bytes | å­—èŠ‚æ•°ç»„ |

### å…³é”®å­—

| ä¸­æ–‡ | Solidity | è¯´æ˜ |
|------|----------|------|
| åˆçº¦ | contract | åˆçº¦å®šä¹‰ |
| å‡½æ•° | function | å‡½æ•°å®šä¹‰ |
| æ„é€ å‡½æ•° | constructor | æ„é€ å‡½æ•° |
| äº‹ä»¶ | event | äº‹ä»¶å®šä¹‰ |
| è¿”å› | return | è¿”å›è¯­å¥ |
| å¦‚æœ | if | æ¡ä»¶è¯­å¥ |
| å¦åˆ™ | else | else åˆ†æ”¯ |
| å¾ªç¯ | for | for å¾ªç¯ |
| å½“ | while | while å¾ªç¯ |
| è¦æ±‚ | require | æ¡ä»¶æ£€æŸ¥ |
| è§¦å‘ | emit | è§¦å‘äº‹ä»¶ |

### å¯è§æ€§ä¿®é¥°ç¬¦

| ä¸­æ–‡ | Solidity |
|------|----------|
| å…¬å¼€ | public |
| ç§æœ‰ | private |
| å†…éƒ¨ | internal |
| å¤–éƒ¨ | external |

### çŠ¶æ€å¯å˜æ€§

| ä¸­æ–‡ | Solidity |
|------|----------|
| åªè¯» | view |
| çº¯å‡½æ•° | pure |
| å¯æ”¯ä»˜ | payable |

### å†…ç½®å˜é‡

| ä¸­æ–‡ | Solidity |
|------|----------|
| æ¶ˆæ¯å‘é€è€… | msg.sender |
| æ¶ˆæ¯å€¼ | msg.value |
| åŒºå—å· | block.number |
| åŒºå—æ—¶é—´ | block.timestamp |

## ğŸ“– å®Œæ•´ç¤ºä¾‹

### ERC20 ä»£å¸åˆçº¦

```
åˆçº¦ æˆ‘çš„ä»£å¸ {
    å…¬å¼€ å­—ç¬¦ä¸² åç§° = "æˆ‘çš„ä»£å¸";
    å…¬å¼€ æ•´æ•° æ€»ä¾›åº”é‡;
    
    æ˜ å°„(åœ°å€ => æ•´æ•°) å…¬å¼€ ä½™é¢;
    
    äº‹ä»¶ è½¬è´¦äº‹ä»¶(åœ°å€ å‘é€è€…, åœ°å€ æ¥æ”¶è€…, æ•´æ•° é‡‘é¢);
    
    æ„é€ å‡½æ•°(æ•´æ•° åˆå§‹ä¾›åº”é‡) {
        æ€»ä¾›åº”é‡ = åˆå§‹ä¾›åº”é‡;
        ä½™é¢[æ¶ˆæ¯å‘é€è€…] = åˆå§‹ä¾›åº”é‡;
    }
    
    å‡½æ•° è½¬è´¦(åœ°å€ æ¥æ”¶è€…, æ•´æ•° é‡‘é¢) å…¬å¼€ è¿”å› å¸ƒå°” {
        è¦æ±‚(ä½™é¢[æ¶ˆæ¯å‘é€è€…] >= é‡‘é¢, "ä½™é¢ä¸è¶³");
        
        ä½™é¢[æ¶ˆæ¯å‘é€è€…] = ä½™é¢[æ¶ˆæ¯å‘é€è€…] - é‡‘é¢;
        ä½™é¢[æ¥æ”¶è€…] = ä½™é¢[æ¥æ”¶è€…] + é‡‘é¢;
        
        è§¦å‘ è½¬è´¦äº‹ä»¶(æ¶ˆæ¯å‘é€è€…, æ¥æ”¶è€…, é‡‘é¢);
        è¿”å› çœŸ;
    }
}
```

## ğŸŒ åœ¨çº¿ç¼–è¯‘å™¨

è®¿é—®åœ¨çº¿ç¼–è¯‘å™¨ä½“éªŒï¼š[https://zhsc.niubiui.com](https://zhsc.niubiui.com)

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
zhsc-compiler/
â”œâ”€â”€ lexer/              # è¯æ³•åˆ†æå™¨
â”‚   â””â”€â”€ chinese_lexer.py
â”œâ”€â”€ parser/             # è¯­æ³•åˆ†æå™¨
â”‚   â””â”€â”€ chinese_parser.py
â”œâ”€â”€ codegen/            # ä»£ç ç”Ÿæˆå™¨
â”‚   â””â”€â”€ solidity_generator.py
â”œâ”€â”€ ast_nodes.py        # AST èŠ‚ç‚¹å®šä¹‰
â”œâ”€â”€ compiler.py         # ç¼–è¯‘å™¨ä¸»ç¨‹åº
â””â”€â”€ examples/           # ç¤ºä¾‹åˆçº¦
    â”œâ”€â”€ helloworld.zhs
    â”œâ”€â”€ token.zhs
    â”œâ”€â”€ voting.zhs
    â””â”€â”€ auction.zhs
```

## ğŸ”§ API ä½¿ç”¨

### ç¼–è¯‘ä»£ç å­—ç¬¦ä¸²

```python
from compiler import compile_code

source_code = """
åˆçº¦ æµ‹è¯• {
    å…¬å¼€ æ•´æ•° æ•°å€¼ = 100;
}
"""

result = compile_code(source_code)
print(result)
```

### ç¼–è¯‘æ–‡ä»¶

```python
from compiler import compile_file

compile_file('input.zhs', 'output.sol', verbose=True)
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢æ‰€æœ‰ä¸ºåŒºå—é“¾æŠ€æœ¯æ™®åŠåšå‡ºè´¡çŒ®çš„å¼€å‘è€…
- ç‰¹åˆ«æ„Ÿè°¢ Solidity å’Œ BSC ç¤¾åŒº

## ğŸ“® è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µï¼š[https://github.com/Anubisya/zhsc-compiler](https://github.com/Anubisya/zhsc-compiler)
- åœ¨çº¿ç¼–è¯‘å™¨ï¼š[https://zhsc.niubiui.com](https://zhsc.niubiui.com)

---

**è®©æ™ºèƒ½åˆçº¦å¼€å‘æ›´ç®€å•ï¼Œè®©åŒºå—é“¾æŠ€æœ¯æ›´äº²æ°‘ï¼** ğŸš€

